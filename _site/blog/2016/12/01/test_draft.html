<!DOCTYPE html>
	<html>
		<head>
			<title>webspider</title>
			<!-- link to main stylesheet -->
			<link rel="stylesheet" type="text/css" href="/css/main.css">
		</head>
		<body class="blackBackground">
			<nav>
	    		<ul>
	        		<li><a href="/">Home</a></li>
	        		<li><a href="/cv">CV</a></li>
	        		<li><a href="/resume" target="_blank">Resume</a></li>
	        		<li><a href="/blog">Blog</a></li>
	    		</ul>
			</nav>
			<div class="container">

			<h1>webspider</h1>
<p class="meta">01 Dec 2016</p>

<div class="post">
  <h3 id="scala-web-spider-with-jsoup">Scala web spider with Jsoup</h3>

<p>The scala web spider can be used, as in this simple example, to parse then list links from HTML at a URL.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// Define a starting link                                                                             
</span><span class="k">val</span> <span class="n">startingLink</span> <span class="k">=</span> <span class="s">"http://imgur.com/r/cats"</span>                                                          

<span class="c1">// Only buffer links from imgur.com                                                                   
</span><span class="k">val</span> <span class="n">buffer</span> <span class="k">=</span> <span class="nc">Spider</span><span class="o">.</span><span class="nc">Buffer</span><span class="o">(</span><span class="s">"imgur.com"</span><span class="o">)</span>                                                               

<span class="c1">// Start crawling a URL with the spider                                                               
</span><span class="nc">Spider</span><span class="o">.</span><span class="nc">Crawl</span><span class="o">(</span><span class="s">"http://imgur.com/r/cats"</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">buffer</span><span class="o">,</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">"href"</span><span class="o">,</span> <span class="s">"src"</span><span class="o">)</span> <span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>                           

<span class="c1">// Create media and link result values, both are URLs as lists of strings                             
</span><span class="n">println</span><span class="o">(</span> <span class="n">buffer</span><span class="o">.</span><span class="n">listMedia</span><span class="o">.</span><span class="n">mkString</span><span class="o">(</span><span class="s">"\nMedia gathered: "</span> <span class="o">+</span> <span class="n">buffer</span><span class="o">.</span><span class="n">sizeMedia</span> <span class="o">+</span> <span class="s">" [\n"</span><span class="o">,</span> <span class="s">"\n"</span><span class="o">,</span> <span class="s">"\n]"</span><span class="o">))</span>     
<span class="n">println</span><span class="o">(</span> <span class="n">buffer</span><span class="o">.</span><span class="n">listLinks</span><span class="o">.</span><span class="n">mkString</span><span class="o">(</span><span class="s">"\nLinks gathered: "</span> <span class="o">+</span> <span class="n">buffer</span><span class="o">.</span><span class="n">sizeLinks</span> <span class="o">+</span> <span class="s">" [\n"</span><span class="o">,</span> <span class="s">"\n"</span><span class="o">,</span> <span class="s">"\n]"</span><span class="o">))</span>     </code></pre></figure>

<p><strong><em>Spider Crawl</em></strong></p>

<p><em>First argument:</em>
URL to start at</p>

<p><em>Second argument:</em>
Number of times to recursively search gathered links (max index for the list of gathered links to search from),
 in this case 1 means we will only scan the first argument, therefore gathering all links and media URLs
on that first linkâ€™s HTML.</p>

<p><em>Third argument:</em>
Pass a buffer object for the crawl to fill as a side-effect .</p>

<p><em>Fourth argument:</em>
A sequence of types to look for.</p>

<p><em>Output:</em> (From running above code assuming Spider is imported already.)</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Starting...

0                                                  100%
--------------------------------------------------
Media gathered: 73 <span class="o">[</span>
http://s.imgur.com/min/gallery.js?1480634721
http://i.imgur.com/s5rB1fub.jpg
.
.
.  <span class="o">]</span>

Links gathered: 102 <span class="o">[</span>
http://imgur.com/r/cats
http://imgur.com/r/cats/3QTBGjAA
.
.
.  <span class="o">]</span></code></pre></figure>

<p>Most of the links were removed from the output for the sake of brevity, but the actual output shows the entire list.</p>

<p><em>Note:</em> Some media is not an image type.</p>

<p><strong><em>Dead link checker</em></strong></p>

<p>Use the dead link checker to find 404 links on your website.</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">buffer</span> <span class="k">=</span> <span class="nc">Spider</span><span class="o">.</span><span class="nc">Buffer</span><span class="o">(</span><span class="s">"http://www.myWebsite.com"</span><span class="o">)</span>                                           
<span class="nc">Spider</span><span class="o">.</span><span class="nc">Crawl</span><span class="o">(</span><span class="s">"http://www.myWebsite.com/"</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="n">buffer</span><span class="o">,</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">"href"</span><span class="o">,</span> <span class="s">"src"</span><span class="o">)</span> <span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>           
<span class="n">println</span><span class="o">(</span> <span class="n">buffer</span><span class="o">.</span><span class="n">listDeadLinks</span><span class="o">.</span><span class="n">mkString</span><span class="o">(</span><span class="s">"\ndead links gathered: "</span> <span class="o">+</span> <span class="n">buffer</span><span class="o">.</span><span class="n">sizeDeadLinks</span> <span class="o">+</span> <span class="s">" [\n"</span><span class="o">,</span> <span class="s">"\n"</span><span class="o">,</span> <span class="s">"]\n"</span><span class="o">))</span>
<span class="n">println</span><span class="o">(</span> <span class="n">buffer</span><span class="o">.</span><span class="n">listLinks</span><span class="o">.</span><span class="n">mkString</span><span class="o">(</span><span class="s">"\nLinks gathered: "</span> <span class="o">+</span> <span class="n">buffer</span><span class="o">.</span><span class="n">sizeLinks</span> <span class="o">+</span> <span class="s">" [\n"</span><span class="o">,</span> <span class="s">"\n"</span><span class="o">,</span> <span class="s">"\n]"</span><span class="o">))</span> </code></pre></figure>

<p>This prints the following:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">Starting...

0                                                  100%
----------------------------------------------------
dead links gathered: 1 <span class="o">[</span>
http://www.myWebsite.com/empty
<span class="o">]</span>

Links gathered: 15 <span class="o">[</span>
http://www.myWebsite.com/
http://www.myWebsite.com/legal/shipping.html
http://www.myWebsite.com/legal/return.html
http://www.myWebsite.com/legal/privacy.html
http://www.myWebsite.com/legal/payment.html
http://www.myWebsite.com/clinics.php
http://www.myWebsite.com/emergencies.php
http://www.myWebsite.com/housecalls.php
http://www.myWebsite.com/pharmacy.php
http://www.myWebsite.com/fees.php
http://www.myWebsite.com/services.php
http://www.myWebsite.com/index.php
http://www.myWebsite.com/current.php
http://www.myWebsite.com/new.php
http://www.myWebsite.com/empty
<span class="o">]</span></code></pre></figure>

<p><em>Note:</em> Sometimes it may produce false negatives, so try running a dead link scan a few times to be sure of results.</p>

<p>In the above example, I changed to domain of the website displayed and also the empty link is pointing to a directory that does not exist.</p>

</div>


			</div><!-- /.container -->
			<footer>
	    		<ul>
	        		<li>Contact Email: hsplatas at gmail dot com</li>
	        		<li><a href="https://github.com/Hugo-Riggs">github.com/Hugo-Riggs</a></li>
				</ul>
			</footer>
		</body>
	</html>
